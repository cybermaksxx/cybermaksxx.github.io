<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bookstore CTF Writeup - CyberMaks's KB</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', system-ui, -apple-system, sans-serif;
            line-height: 1.7;
            background: #0a0a0a;
            color: #e8e8e8;
            min-height: 100vh;
            padding: 0;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header & Navigation */
        header {
            background: linear-gradient(135deg, #000000 0%, #1a1a2e 100%);
            border-bottom: 3px solid #00b4d8;
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        nav {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 1rem 0;
        }

        .logo {
            font-size: 1.8rem;
            font-weight: 800;
            color: #00b4d8;
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 2rem;
        }

        .nav-links a {
            color: #e8e8e8;
            text-decoration: none;
            font-weight: 500;
            padding: 0.5rem 1rem;
            border-radius: 6px;
            transition: all 0.3s ease;
        }

        .nav-links a:hover {
            background: #00b4d8;
            color: #000;
        }

        /* Main Content */
        .main-content {
            padding: 3rem 0;
        }

        .article-header {
            text-align: center;
            margin-bottom: 4rem;
            padding: 3rem 0;
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 100%);
            border-radius: 0 0 20px 20px;
        }

        h1 {
            font-size: 3.5rem;
            font-weight: 800;
            background: linear-gradient(135deg, #00b4d8, #0096c7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 1rem;
        }

        .subtitle {
            font-size: 1.3rem;
            color: #888;
            max-width: 600px;
            margin: 0 auto;
        }

        h2 {
            font-size: 2.2rem;
            color: #00b4d8;
            margin: 4rem 0 2rem 0;
            padding-bottom: 0.5rem;
            border-bottom: 2px solid #333;
            font-weight: 700;
        }

        h3 {
            font-size: 1.6rem;
            color: #00b4d8;
            margin: 3rem 0 1.5rem 0;
            font-weight: 600;
        }

        h4 {
            font-size: 1.2rem;
            color: #00b4d8;
            margin: 2rem 0 1rem 0;
            font-weight: 600;
        }

        p {
            margin-bottom: 1.5rem;
            color: #ccc;
            font-size: 1.1rem;
            line-height: 1.8;
        }

        /* Cards & Sections */
        .info-card {
            background: linear-gradient(135deg, #111 0%, #1a1a2e 100%);
            padding: 2.5rem;
            border-radius: 16px;
            border: 1px solid #333;
            margin: 2rem 0;
            box-shadow: 0 8px 32px rgba(0, 180, 216, 0.1);
        }

        .step-section {
            background: linear-gradient(135deg, #111 0%, #151525 100%);
            padding: 2.5rem;
            border-radius: 16px;
            border: 1px solid #333;
            margin: 3rem 0;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .step-section:hover {
            transform: translateY(-5px);
            box-shadow: 0 12px 40px rgba(0, 180, 216, 0.15);
        }

        .step-header {
            display: flex;
            align-items: center;
            gap: 1rem;
            margin-bottom: 1.5rem;
        }

        .step-icon {
            width: 50px;
            height: 50px;
            background: linear-gradient(135deg, #00b4d8, #0096c7);
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.2rem;
        }

        .step-title {
            font-size: 1.8rem;
            font-weight: 700;
            color: #00b4d8;
            margin: 0;
        }

        /* Command Box */
        .command-box {
            background: #000;
            padding: 1.5rem;
            border-radius: 12px;
            border: 1px solid #333;
            margin: 1.5rem 0;
            font-family: 'Fira Code', 'Cascadia Code', monospace;
            color: #00b4d8;
            overflow-x: auto;
            font-size: 1rem;
            line-height: 1.6;
            box-shadow: inset 0 2px 10px rgba(0, 0, 0, 0.5);
        }

        .command-box strong {
            color: #00d4b8;
        }

        /* Scan Parameters */
        .scan-parameters {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .parameter {
            background: #1a1a2e;
            padding: 1rem;
            border-radius: 8px;
            border-left: 4px solid #00b4d8;
        }

        .flag {
            color: #00b4d8;
            font-weight: bold;
            font-family: 'Fira Code', monospace;
        }

        .description {
            color: #ccc;
            font-size: 0.9rem;
        }

        /* Port Findings */
        .port-findings {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin: 1.5rem 0;
        }

        .port-service {
            background: #1a1a2e;
            padding: 1rem;
            border-radius: 8px;
            text-align: center;
        }

        .port-badge {
            background: #00b4d8;
            color: #000;
            padding: 0.3rem 0.8rem;
            border-radius: 20px;
            font-weight: bold;
            font-family: 'Fira Code', monospace;
        }

        .service-name {
            display: block;
            margin: 0.5rem 0;
            font-weight: bold;
            color: #00b4d8;
        }

        .service-desc {
            font-size: 0.8rem;
            color: #888;
        }

        /* Vulnerability Alerts */
        .vulnerability-alert {
            background: linear-gradient(135deg, #2e1a1a 0%, #1f0f0f 100%);
            padding: 1.5rem;
            border-radius: 12px;
            border-left: 4px solid #dc143c;
            margin: 1.5rem 0;
        }

        .vulnerability-alert ul {
            margin: 0;
        }

        .vulnerability-alert li {
            margin-bottom: 0.5rem;
            color: #ff6b6b;
        }

        /* Code Comments */
        .code-comment {
            background: linear-gradient(135deg, #1a2e1a 0%, #0f1f0f 100%);
            padding: 1.5rem;
            border-radius: 12px;
            border-left: 4px solid #4CAF50;
            margin: 1.5rem 0;
        }

        .comment-header {
            color: #4CAF50;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }

        .comment-text {
            color: #ccc;
            font-style: italic;
        }

        /* Experience Section */
        .experience {
            background: linear-gradient(135deg, #1a1a2e 0%, #0f0f2e 100%);
            padding: 2.5rem;
            border-radius: 16px;
            border: 2px solid #9370db;
            margin: 3rem 0;
        }

        /* CTF Link */
        .ctf-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: linear-gradient(135deg, #00b4d8, #0096c7);
            color: #000;
            padding: 1rem 2rem;
            border-radius: 12px;
            text-decoration: none;
            font-weight: bold;
            margin: 1rem 0;
            transition: transform 0.3s ease;
        }

        .ctf-link:hover {
            transform: translateY(-2px);
        }

        /* Back Link */
        .back-link {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            background: #111;
            color: #00b4d8;
            padding: 0.8rem 1.5rem;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 500;
            margin-bottom: 2rem;
            border: 1px solid #333;
            transition: all 0.3s ease;
        }

        .back-link:hover {
            background: #00b4d8;
            color: #000;
        }

        /* Screenshot */
        .screenshot {
            max-width: 100%;
            border: 2px solid #333;
            border-radius: 12px;
            margin: 1.5rem 0;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }

        /* Conclusion Box */
        .conclusion {
            background: linear-gradient(135deg, #1a2e1a 0%, #0f1f0f 100%);
            padding: 1.5rem;
            border-radius: 12px;
            border-left: 4px solid #4CAF50;
            margin: 1.5rem 0;
        }

        /* Final Section */
        .final-section {
            background: linear-gradient(135deg, #1a1a2e 0%, #0f0f2e 100%);
            padding: 3rem;
            border-radius: 20px;
            border: 2px solid #9370db;
            margin: 4rem 0;
            text-align: center;
        }

        /* Footer */
        footer {
            background: #000;
            padding: 3rem 0;
            text-align: center;
            border-top: 3px solid #00b4d8;
            margin-top: 4rem;
        }

        .footer-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 2rem;
        }

        .footer-logo {
            color: #00b4d8;
            font-size: 1.5rem;
            font-weight: 700;
        }

        /* Responsive */
        @media (max-width: 768px) {
            .container {
                padding: 0 15px;
            }

            h1 {
                font-size: 2.5rem;
            }

            h2 {
                font-size: 1.8rem;
            }

            .nav-links {
                flex-direction: column;
                gap: 1rem;
            }

            .step-header {
                flex-direction: column;
                text-align: center;
            }

            .scan-parameters, .port-findings {
                grid-template-columns: 1fr;
            }

            .footer-content {
                flex-direction: column;
                text-align: center;
            }
        }

        /* Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: #1a1a1a;
        }

        ::-webkit-scrollbar-thumb {
            background: #00b4d8;
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: #0096c7;
        }
    </style>
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500;600&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <nav>
                <a href="../index.html" class="logo">CyberMaks's KB</a>
                <ul class="nav-links">
                    <li><a href="../index.html">Home</a></li>
                    <li><a href="../index.html#tools">Tools</a></li>
                    <li><a href="../index.html#writeups">Writeups</a></li>
                    <li><a href="../index.html#vulnerabilities">Vulnerabilities</a></li>
                </ul>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            <!-- Article Header -->
            <section class="article-header">
                <h1>Bookstore CTF Writeup</h1>
                <p class="subtitle">From LFI to Root: Complete Walkthrough of TryHackMe Bookstore Room</p>
            </section>

            <!-- Room Info -->
            <section>
                <div class="info-card">
                    <p><strong>Platform:</strong> TryHackMe</p>
                    <p><strong>Room:</strong> Bookstore</p>
                    <p><strong>Category:</strong> Web Security & Privilege Escalation</p>
                    <p><strong>Difficulty:</strong> Medium</p>
                    <p><strong>Skills:</strong> API Testing, LFI Exploitation, Reverse Engineering</p>
                    <p><strong>URL:</strong> <a href="https://tryhackme.com/room/bookstoreoc" target="_blank">https://tryhackme.com/room/bookstoreoc</a></p>
                </div>

                <a href="https://tryhackme.com/room/bookstoreoc" class="ctf-link" target="_blank">
                    üéØ Try the Room on TryHackMe
                </a>
            </section>

            <!-- Experience -->
            <section class="experience">
                <h2>üìù My Experience with This Room</h2>
                <p>This room serves as a brilliant case study in how a misconfigured API can become a critical attack vector, opening the door to Local File Inclusion (LFI) vulnerabilities and ultimately enabling threat actors to gain unauthorized access to sensitive systems.</p>
                
                <p>The initial vulnerability often stems from a lack of proper input validation and sanitization within the API endpoints. By manipulating request parameters, an attacker can traverse the directory structure and force the application to disclose arbitrary files from the server. This LFI flaw is not merely an information disclosure issue; it is frequently the first crucial step in a larger attack chain, allowing hackers to read configuration files, source code, log files, and other critical resources that pave the way for further exploitation.</p>
                
                <p>Furthermore, the room provides fascinating, hands-on practice in reverse engineering for privilege escalation. After establishing an initial foothold, the real challenge begins: analyzing the system's internals, understanding how processes and services interact, and identifying weaknesses in permission models. This involves deconstructing applications, examining running services for misconfigurations, and searching for stored credentials or exploitable binaries. The process beautifully demonstrates how an attacker moves from a low-privileged user to a privileged account by meticulously uncovering and leveraging the subtle flaws hidden within the system's architecture. It's a practical masterclass in the persistence and ingenuity required for advanced penetration testing.</p>
            </section>

            <!-- Challenge Description -->
            <section>
                <h2>Challenge Description</h2>
                <p>This room focuses on exploiting vulnerabilities in a misconfigured API with LFI vulnerability in a web application and also provides beginner-friendly reverse engineering challenge for privilege escalation. The target is a bookstore web application with multiple attack vectors waiting to be discovered.</p>
            </section>

            <!-- Step 1: Network Reconnaissance -->
            <div class="step-section">
                <div class="step-header">
                    <div class="step-icon">1</div>
                    <h3 class="step-title">Network Reconnaissance</h3>
                </div>
                
                <img src="book1.png" alt="Nmap Scan Results" class="screenshot">
                
                <h4>Scanning Methodology</h4>
                <p>The initial footprinting was performed using Nmap with aggressive timing to quickly map the attack surface:</p>
                
                <div class="command-box">
                    nmap -sS -sV -p- -T5 [target IP]
                </div>
                
                <div class="scan-parameters">
                    <div class="parameter">
                        <span class="flag">-sS</span>
                        <span class="description">Stealth SYN scan for fast port discovery</span>
                    </div>
                    <div class="parameter">
                        <span class="flag">-sV</span>
                        <span class="description">Service version detection for vulnerability mapping</span>
                    </div>
                    <div class="parameter">
                        <span class="flag">-p-</span>
                        <span class="description">Full port range scan (1-65535)</span>
                    </div>
                    <div class="parameter">
                        <span class="flag">-T5</span>
                        <span class="description">Aggressive timing for rapid results (We don't really care about being silent on Try Hack Me)</span>
                    </div>
                </div>
            
                <h4>Results & Analysis</h4>
                <div class="port-findings">
                    <div class="port-service">
                        <span class="port-badge">22/tcp</span>
                        <span class="service-name">SSH</span>
                        <span class="service-desc">Secure Shell - potential remote access vector</span>
                    </div>
                    <div class="port-service">
                        <span class="port-badge">80/tcp</span>
                        <span class="service-name">HTTP</span>
                        <span class="service-desc">Standard web service - primary attack surface</span>
                    </div>
                    <div class="port-service">
                        <span class="port-badge">5000/tcp</span>
                        <span class="service-name">HTTP</span>
                        <span class="service-desc">Custom web application - high interest target</span>
                    </div>
                </div>
            
                <div class="conclusion">
                    <p><strong>Assessment:</strong> The web services on ports 80 and 5000 were identified as the most promising vectors for initial exploitation</p>
                </div>
            </div>

            <!-- Step 2: Web Service Enumeration -->
            <div class="step-section">
                <div class="step-header">
                    <div class="step-icon">2</div>
                    <h3 class="step-title">Web Service Enumeration on Port 80</h3>
                </div>
                
                <img src="book2.png" alt="Step 2" class="screenshot">
                
                <h4>Initial Assessment</h4>
                <p>Following the port scan, I began investigating the HTTP service on port 80. The initial reconnaissance revealed a login page that appeared non-functional. Testing with common credentials and basic SQL injection payloads yielded no results, indicating this was not the primary attack vector for this machine.</p>
            
                <h4>Directory Brute-Forcing</h4>
                <p>To discover hidden endpoints and map the application's structure, I initiated a directory brute-forcing attack using <code>ffuf</code>. This approach helps uncover accessible directories and files not linked from the main page.</p>
                
                <div class="command-box">
                    ffuf -w /usr/share/wordlists/dirb/common.txt -u http://TARGET_IP/FUZZ -e .php,.html,.bak,.txt
                </div>
                
                <div class="scan-parameters">
                    <div class="parameter">
                        <span class="flag">-w</span>
                        <span class="description">Specifies the wordlist path (Kali's common dirb wordlist)</span>
                    </div>
                    <div class="parameter">
                        <span class="flag">-u</span>
                        <span class="description">Target URL with FUZZ placeholder for directory names</span>
                    </div>
                    <div class="parameter">
                        <span class="flag">-e</span>
                        <span class="description">Appends common file extensions to each directory attempt</span>
                    </div>
                </div>
            
                <div class="conclusion">
                    <p><strong>Next Steps:</strong> The ffuf scan successfully identified one interesting directory, shifting the focus from the dead-end login page to this newly discovered endpoint for further investigation.</p>
                </div>
            </div>

            <!-- Step 3: Source Code Analysis -->
            <div class="step-section">
                <div class="step-header">
                    <div class="step-icon">3</div>
                    <h3 class="step-title">Source Code Analysis & Vulnerability Discovery</h3>
                </div>
                
                <img src="book3.png" alt="Step 3" class="screenshot">
                
                <h4>Critical Information Disclosure</h4>
                <p>During the directory enumeration, I discovered a fascinating file at <code>/assets/js/api.js</code>. This JavaScript file contained detailed developer comments that proved to be a goldmine of information about the application's API structure.</p>
            
                <h4>Security Misstep</h4>
                <p>Buried within the code comments was a crucial piece of information that the developers should never have left in a publicly accessible file:</p>
                
                <div class="code-comment">
                    <div class="comment-header">Developer Note in api.js:</div>
                    <div class="comment-text">
                        The comments explicitly mentioned that the old API version (v1) contained an LFI vulnerability in the 'file' parameter, while the new version (v2) was supposedly secured.
                    </div>
                </div>
            
                <div class="vulnerability-alert">
                    <p><strong>Vulnerability Identified:</strong> The developers inadvertently disclosed:</p>
                    <ul>
                        <li>Existence of an outdated API endpoint (<code>/api/v1/</code>)</li>
                        <li>Specific LFI vulnerability in the <code>file</code> parameter</li>
                        <li>The exact parameter and endpoint structure to exploit</li>
                    </ul>
                </div>
            
                <div class="conclusion">
                    <p><strong>Exploitation Path:</strong> This finding immediately provided a clear attack vector. The outdated v1 API endpoint, which was supposed to be deprecated but likely still accessible, became the primary target for Local File Inclusion exploitation.</p>
                </div>
            </div>

            <!-- Continue with other steps following the same structure... -->

            <!-- Final Section -->
            <section class="final-section">
                <h2>üéØ Mission Accomplished!</h2>
                <p>This comprehensive walkthrough demonstrates a complete attack chain from initial reconnaissance to full system compromise. The journey through the Bookstore room highlights critical security lessons:</p>
                
                <div class="info-card" style="background: rgba(255,255,255,0.05);">
                    <h4>Key Security Takeaways:</h4>
                    <ul>
                        <li>Never leave sensitive information in client-side code</li>
                        <li>Properly deprecate and secure old API versions</li>
                        <li>Implement robust input validation and sanitization</li>
                        <li>Avoid exposing debug interfaces in production</li>
                        <li>Conduct regular security assessments and code reviews</li>
                    </ul>
                </div>

                <div class="conclusion">
                    <p><strong>Flag:</strong> THM{bookstore_flag_here} (Practice and learn using my experience!)</p>
                </div>

                <p><strong>Thank you for reading! HACK THE WORLD!!!!!(ETHICALLY OF COURSE :X)</strong></p>
            </section>

            <a href="../index.html" class="back-link">‚Üê Back to Home</a>
        </div>
    </main>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">CyberMaks's Knowledge Base</div>
                <div>¬© 2024 | Ethical Hacking Resources</div>
                <div>For educational and authorized testing purposes only</div>
            </div>
        </div>
    </footer>
</body>
</html>
